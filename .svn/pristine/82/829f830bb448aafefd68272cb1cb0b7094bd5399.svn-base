<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<!DOCTYPE HTML>
<head>
	<title>Purple Buzz HTML Template with Bootstrap 5 Beta 1</title>
	<meta charset="utf-8">
	<script src="/resources/asset/js/jquery.min.js"></script>
	<%@include file="include/option.jsp" %>
	
	<style>
		td, th {
			text-align: center;
		}
		
		tr{
			height: 15px;
		}
		
		th {
			font-size: 1.2em;
		}
		
		td:nth-child(1), th:nth-child(1) {
			width: 5%;
		}
		
		td:nth-child(2), th:nth-child(2) {
			width: 30%;
		}
		
		td:nth-child(3), th:nth-child(3) {
			width: 15%;
		}
		
		select{
			border:1px solid #ced4da;
			height: 38px;
 			border-radius:7%; 
		}
		
	
	</style>
	
</head>

<body>
	<%@include file="include/header.jsp" %>
	
	<section class="container overflow-hidden py-5">
	<h1 class="text-dark h1" style="text-align:left;">갤러리 렌트 목록</h1>
		<br/>
		<div>
			<!-- 테이블 시작 -->
			<table class="table table-sm table-hover">
				<thead>
					<tr>
						<th scope="col">No.</th>
						<th scope="col">갤러리명</th>
						<th scope="col">전화번호</th>
						<th scope="col">환불버튼</th>
					</tr>
				</thead>

				<tbody>
					<c:choose>
						<c:when test="${GrentList.size() > 0}">
							<c:forEach var="gallery" items="${GrentList}">
								<tr>
									<td scope="col">${gallery.rent_name}</td>
									<td scope="col">${gallery.rent_email}</td>
									<td scope="col">${gallery.rent_tel}</td>
									<c:choose>
										<c:when test="${gallery.cancel_yn eq 'n'}">
											<td scope="col"><button class="btn btn-primary" onclick="refund('${gallery.rent_num}')">환불하기</button></td>
										</c:when>
										<c:otherwise>
											환불됨
										</c:otherwise>
									</c:choose>
								</tr>
							</c:forEach>
							
						
						</c:when>
						<c:otherwise>
							<tr>
								<td colspan="6" rowspan="10">데이터가 없습니다.</td>
							</tr>
						</c:otherwise>
					</c:choose>
				</tbody>				
			</table>
		</div>
		
	</section>
	
	<footer style="position:absolute;width:100%;top:900px;">
		<%@include file="include/footer.jsp" %>
	</footer>
	<script>
 		function galleryDetail(gallery_num){
 			location.href="/myGalleryDetail?gallery_num=" + gallery_num;
 		}
 		
 		function refund(rent_num){
 			alert(rent_num);
 			
 		$.ajax({
 				url: "/galleryRentRefund",
 				type:"post",
 				contentType : 'application/x-www-form-urlencoded; charset = utf-8',
 				data : {
 					"rent_num" : rent_num,
 				}
 			}).done(function(result){ //환불 성공
 				console.log("환불 성공 : "+ result);
 			}).fail(function(error){
 				console.log("환불 실패 : "+ error);
 			});//ajax
 		}
 	</script>
	
</body>
</html>