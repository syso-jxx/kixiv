<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

<!-- 변경확인 -->
<!DOCTYPE HTML>
<head>
<title>KIXIV - 세상의 모든 사진</title>
<meta charset="utf-8">
<%@include file="include/option.jsp" %>

<style>
	body {
	  font-family: Arial;
	  margin: 0;
	}
	
	* {
	  box-sizing: border-box;
	}
	
	img {
	  vertical-align: middle;
	}
	
	/* Position the image container (needed to position the left and right arrows) */
	.container {
	  position: relative;
	}
	
	/* Hide the images by default */
	.mySlides {
	  display: none;
	}
	
	/* Add a pointer when hovering over the thumbnail images */
	.cursor {
	  cursor: pointer;
	}
	
	/* Next & previous buttons */
	.prev,
	.next {
	  cursor: pointer;
	  position: absolute;
	  top: 40%;
	  width: auto;
	  padding: 16px;
	  margin-top: -50px;
	  color: white;
	  font-weight: bold;
	  font-size: 20px;
	  border-radius: 0 3px 3px 0;
	  user-select: none;
	  -webkit-user-select: none;
	}
	
	/* Position the "next button" to the right */
	.next {
	  right: 0;
	  border-radius: 3px 0 0 3px;
	}
	
	/* On hover, add a black background color with a little bit see-through */
	.prev:hover,
	.next:hover {
	  background-color: rgba(0, 0, 0, 0.8);
	}
	
	/* Number text (1/3 etc) */
	.numbertext {
	  color: #f2f2f2;
	  font-size: 12px;
	  padding: 8px 12px;
	  position: absolute;
	  top: 0;
	}
	
	/* Container for image text */
	.caption-container {
	  text-align: center;
	  background-color: #222;
	  padding: 2px 16px;
	  color: white;
	}
	
	.row:after {
	  content: "";
	  display: table;
	  clear: both;
	}
	
	/* Six columns side by side */
	.column {
	  float: left;
	  width: 16.66%;
	}
	
	/* Add a transparency effect for thumnbail images */
	.demo {
	  opacity: 0.6;
	}
	
	.active,
	.demo:hover {
	  opacity: 1;
	}
</style>

<script>
	var slideIndex = 1;
	showSlides(slideIndex);
	
	function plusSlides(n) {
	  showSlides(slideIndex += n);
	}
	
	function currentSlide(n) {
	  showSlides(slideIndex = n);
	}
	
	function showSlides(n) {
	  var i;
	  var slides = document.getElementsByClassName("mySlides");
	  var dots = document.getElementsByClassName("demo");
	  if (n > slides.length) {slideIndex = 1}
	  if (n < 1) {slideIndex = slides.length}
	  for (i = 0; i < slides.length; i++) {
	      slides[i].style.display = "none";
	  }
	  for (i = 0; i < dots.length; i++) {
	      dots[i].className = dots[i].className.replace(" active", "");
	  }
	  slides[slideIndex-1].style.display = "block";
	  dots[slideIndex-1].className += " active";
	}
</script>

</head>
<body>
<%@include file="include/header.jsp" %>
	<!-- Start Service -->
	<section class="service-wrapper py-3">
		<div class="service-tag py-5 bg-secondary">
			<div class="col-md-12">
				<ul class="nav d-flex justify-content-center">
					<li class="nav-item mx-lg-4"><a
						class="filter-btn nav-link btn-outline-primary rounded-pill text-light px-4 light-300" href="funding">펀딩홈</a>
					</li>
					<li class="filter-btn nav-item mx-lg-4">
						<a class="filter-btn nav-link btn-outline-primary rounded-pill text-light px-4 light-300" href="funding?fund_code=cms">오픈예정</a>
					</li>
				</ul>
			</div>
		</div>
	</section>
	
	<section class="container overflow-hidden py-5">
		<!-- Pre-loader start -->
  <div class="theme-loader">
      <div class="loader-track">
          <div class="preloader-wrapper">
              <div class="spinner-layer spinner-blue">
                  <div class="circle-clipper left">
                      <div class="circle"></div>
                  </div>
                  <div class="gap-patch">
                      <div class="circle"></div>
                  </div>
                  <div class="circle-clipper right">
                      <div class="circle"></div>
                  </div>
              </div>
              <div class="spinner-layer spinner-red">
                  <div class="circle-clipper left">
                      <div class="circle"></div>
                  </div>
                  <div class="gap-patch">
                      <div class="circle"></div>
                  </div>
                  <div class="circle-clipper right">
                      <div class="circle"></div>
                  </div>
              </div>
            
              <div class="spinner-layer spinner-yellow">
                  <div class="circle-clipper left">
                      <div class="circle"></div>
                  </div>
                  <div class="gap-patch">
                      <div class="circle"></div>
                  </div>
                  <div class="circle-clipper right">
                      <div class="circle"></div>
                  </div>
              </div>
            
              <div class="spinner-layer spinner-green">
                  <div class="circle-clipper left">
                      <div class="circle"></div>
                  </div>
                  <div class="gap-patch">
                      <div class="circle"></div>
                  </div>
                  <div class="circle-clipper right">
                      <div class="circle"></div>
                  </div>
              </div>
          </div>
      </div>
  </div>
  
  <!-- jstl 변수선언부 시작 -->
  <c:set var="sdate"><fmt:formatDate value="${fund.fund_sdate}" pattern="yyyy/MM/dd"/></c:set>
  <c:set var="edate"><fmt:formatDate value="${fund.fund_edate}" pattern="yyyy/MM/dd"/></c:set>
  <c:set var="today"><fmt:formatDate value="<%=new java.util.Date()%>" pattern="yyyy/MM/dd"/></c:set>
  
  <fmt:parseDate value="${today}" var="todayPlanDate" pattern="yyyy/MM/dd"/>
  <fmt:parseNumber value="${todayPlanDate.time / (1000*60*60*24)}" integerOnly="true" var="todayDate"></fmt:parseNumber>
  <fmt:parseDate value="${edate}" var="endPlanDate" pattern="yyyy/MM/dd"/>
  <fmt:parseNumber value="${endPlanDate.time / (1000*60*60*24)}" integerOnly="true" var="endDate"></fmt:parseNumber>
  
  <c:set var="total"><fmt:formatNumber value="${fund.total}" pattern="#,###"/></c:set>
  <c:set var="achieve"><fmt:formatNumber value="${fund.fund_achieve}" pattern="#,###"/></c:set>
  
  <fmt:parseNumber var="rate" type="number" value="${fund.rate}" />
  <!-- jstl 변수선언부 끝-->
  
  <!-- Pre-loader end -->
  <div id="pcoded" class="pcoded">
      <div class="pcoded-overlay-box"></div>
      <div class="pcoded-container navbar-wrapper">
          <div class="pcoded-main-container">
              <div class="pcoded-wrapper">
                      <!-- Page-header end -->
                        <div class="pcoded-inner-content">
                            <!-- Main-body start -->
                            <div class="main-body">
                                <div class="page-wrapper">
                                    <!-- Page-body start -->
                                    <div class="page-body">
                                        <div class="row">
                                        	<!-- task, page, download counter  start -->
                                            <div class="col-xl-3 col-md-6" style="margin-bottom: 50px;">
                                                <div class="card">
                                                    <div class="card-block">
                                                        <div class="row align-items-center">
                                                            <div class="col-8">
                                                                <h4 class="text-muted m-b-0">펀딩 목표액</h4>
                                                                <h2 class="text-c-purple">${achieve}</h2>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-md-6">
                                                <div class="card">
                                                    <div class="card-block">
                                                        <div class="row align-items-center">
                                                            <div class="col-8">
                                                                <h4 class="text-muted m-b-0">현재 모금액</h4>
                                                                <h2 class="text-c-blue">${total}</h2>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-md-6" style="margin-bottom: 50px;">
                                                <div class="card">
                                                    <div class="card-block">
                                                        <div class="row align-items-center">
                                                            <div class="col-8">
                                                                <h4 class="text-muted m-b-0">펀딩 시작일</h4>
                                                            	<h2 class="text-c-blue">${sdate}</h2>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-3 col-md-6">
                                                <div class="card">
                                                    <div class="card-block">
                                                        <div class="row align-items-center">
                                                            <div class="col-8">
                                                                <h4 class="text-muted m-b-0">펀딩 종료일</h4>
                                                                <h2 class="text-c-blue">${edate}</h2>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- task, page, download counter  end -->
                                        
                                            <!--  sale analytics start -->
                                            <div class="col-xl-8 col-md-12">
                                                <div class="card">
                                                    <div class="card-header">
                                                        <h5>${fund.fund_title}</h5>
                                                        <div class="card-header-right">
                                                            <ul class="list-unstyled card-option">
                                                                <li><i class="fa fa fa-wrench open-card-option"></i></li>
                                                                <li><i class="fa fa-window-maximize full-card"></i></li>
                                                                <li><i class="fa fa-minus minimize-card"></i></li>
                                                                <li><i class="fa fa-refresh reload-card"></i></li>
                                                                <li><i class="fa fa-trash close-card"></i></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    <div class="card-block">
                                                        <div id="sales-analytics" style="height: 400px;">
                                                        	<pre>${fund.fund_content}</pre>
                                                        </div>
                                                    </div>
                                                    <!-- 사진스크롤 시작 -->
                                                    <c:if test="${fn:length(fundPicList) != 0}">
	                                                    <div class="card-header">
	                                                       <h5>작가의 사진</h5>
	                                                    </div>
	                                                    <div class="card-block">
															<div class="container" style="padding:0;">
																<c:forEach items="${fundPicList}" var="picture" varStatus="status">
																	<div class="mySlides">
																		<div class="numbertext">${status.count} / ${fn:length(fundPicList)}</div>
																		<img src="${picture.FUND_PICPATH}" style="width:100%; height:500px;">
																	</div>
																</c:forEach>
																<a class="prev" onclick="plusSlides(-1)">❮</a>
																<a class="next" onclick="plusSlides(1)">❯</a>
																	
																<div class="row">
																	<c:forEach items="${fundPicList}" var="picture" varStatus="status">
																		<div class="column">
																			<img class="demo cursor" src="${picture.FUND_PICPATH}" style="width:100%; height:100px;" onclick="currentSlide(${status.count})" alt="${picture.PICSEQ}">
																		</div>
																	</c:forEach>
																</div>
															</div>
	                                                    </div>
                                                    </c:if>
                                                    <!-- 사진스크롤 끝 -->
												</div>
                                            </div>

                                            <div class="col-xl-4 col-md-12">
                                                <div class="card" style="margin-bottom: 5%;">
                                                    <div class="card-block">
                                                        <div class="row">
                                                            <div class="col">
                                                            	<h5>1인당 펀딩금액</h5>
                                                                <h1><fmt:formatNumber value="${fund.one_price}" pattern="#,###"/></h1>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div>
                                           				<button id="fundBtn" class="btn btn-info waves-effect waves-light" style="width:100%; height: 80px;">투자하기</button>		
                                                   		<button id="report" class="btn btn-danger waves-effect waves-light" style="width:100%; height: 80px; margin-top: 5px;">신고하기</button>
                                                   		<button id="delete" class="btn btn-info waves-effect waves-light" style="width:100%; height: 80px; margin-top: 5px; display:none;" onclick="#">삭제하기</button>
                                                   		<!-- 펀딩예정 or 마감된펀딩의 경우 투자하기 버튼 삭제 -->
                                                   		<c:if test="${sdate > today or edate < today or userId == fund.user_id}">
                                                   			<script type="text/javascript">
                                                   				document.getElementById("fundBtn").style.display="none";
                                                   			</script>
                                                   		</c:if>
                                                   		<!-- 글쓴이일때만 신고하기 버튼 비활성화-->
                                                   		<c:if test="${userId == fund.user_id}">
                                                   			<script type="text/javascript">
                                                   				document.getElementById("report").style.display="none";
                                                   			</script>
                                                   		</c:if>
                                                   		<!-- 오픈 예정이면서 글쓴이 본인일때만 삭제버튼 활성화 -->
                                                   		<c:if test="${sdate > today and userId == fund.user_id}">
                                                   			<script type="text/javascript">
	                                                   			document.getElementById("delete").style.display="block";
                                                   			</script>
                                                   		</c:if>
                                          			</div>
                                                </div>
                                                <div class="card quater-card" style="margin-bottom: 5%;">
                                                    <div class="card-block">
                                                        <p class="text-muted">목표 달성률</p>
                                                        <h5>${fund.rate}%</h5>
                                                        <c:choose>
                                                        	<c:when test="${rate > 100}">
                                                        		<div class="progress" style="height:20px; text-align: center;"><div class="progress-bar bg-c-blue" style="width: 100%;"></div></div>
                                                        	</c:when>
                                                        	
                                                        	<c:otherwise>
                                                        		<div class="progress" style="height:20px; text-align: center;"><div class="progress-bar bg-c-blue" style="width: ${fund.rate}%;"></div></div>	
                                                        	</c:otherwise>
                                                        </c:choose>
                                                        <br/>
                                                        <p class="text-muted">목표 달성까지 남은금액</p>
                                                        <h5>
                                                        <c:choose>
                                                        	<c:when test="${rate >= 100}">
                                                        		목표달성!
                                                        	</c:when>
                                                        	
                                                        	<c:otherwise>
                                                        		<fmt:formatNumber value="${fund.fund_achieve-fund.total}" pattern="#,###"/>
                                                        	</c:otherwise>
                                                        
                                                        </c:choose>
                                                        
                                                        
                                                        </h5>
                                                        <br/>
                                                        <h6 class="text-muted m-b-15">펀딩 마감일까지</h6>
                                                        <h4>
                                                        <c:choose>
                                                        	<c:when test="${edate < today}">
                                                        		마감됨
                                                        	</c:when>
                                                        	
                                                        	<c:when test="${sdate > today}">
                                                        		오픈예정
                                                        	</c:when>
                                                        	
                                                        	<c:otherwise>
                                                        		D - ${endDate - todayDate}
                                                        	</c:otherwise>
                                                        
                                                        </c:choose>
                                                        
                                                        </h4>
                                                    </div>
                                                </div>
                                                <!-- ======================== 작가 정보 작성 예정 ========================-->
                                                <div class="card quater-card">
                                                    <div class="card-block">
                                                        <p class="text-muted">목표 달성률</p>
                                                        <h5>${fund.rate}%</h5>
                                                        <c:choose>
                                                        	<c:when test="${rate > 100}">
                                                        		<div class="progress" style="height:20px; text-align: center;"><div class="progress-bar bg-c-blue" style="width: 100%;"></div></div>
                                                        	</c:when>
                                                        	
                                                        	<c:otherwise>
                                                        		<div class="progress" style="height:20px; text-align: center;"><div class="progress-bar bg-c-blue" style="width: ${fund.rate}%;"></div></div>	
                                                        	</c:otherwise>
                                                        </c:choose>
                                                        <br/>
                                                        <p class="text-muted">목표 달성까지 남은금액</p>
                                                        <h5>
                                                        <c:choose>
                                                        	<c:when test="${rate >= 100}">
                                                        		목표달성!
                                                        	</c:when>
                                                        	
                                                        	<c:otherwise>
                                                        		<fmt:formatNumber value="${fund.fund_achieve-fund.total}" pattern="#,###"/>
                                                        	</c:otherwise>
                                                        
                                                        </c:choose>
                                                        </h5>
                                                        <br/>
                                                        <h6 class="text-muted m-b-15">펀딩 마감일까지</h6>
                                                        <h4>
                                                        <c:choose>
                                                        	<c:when test="${edate < today}">
                                                        		마감됨
                                                        	</c:when>
                                                        	
                                                        	<c:when test="${sdate > today}">
                                                        		오픈예정
                                                        	</c:when>
                                                        	
                                                        	<c:otherwise>
                                                        		D - ${endDate - todayDate}
                                                        	</c:otherwise>
                                                        
                                                        </c:choose>
                                                        
                                                        </h4>
                                                    </div>
                                                </div>
                                            </div>
                                            <!--  sale analytics end -->
                                            
                                            <c:if test="${fundCode == 'A001'}">
                                            <!--  project and team member start -->
                                            <div class="col-xl-8 col-md-12" style="margin-top:2%;">
                                                <div class="card table-card">
                                                    <div class="card-header">
                                                        <h5>갤러리 위치</h5>
                                                        <div class="card-header-right">
														<!-- Markers map start -->
						                                    <div class="card">
						                                        <div class="card-header">
						                                            <h5>Markers</h5>
						                                            <span>Maps shows <code>location</code> of the place</span>
						                                        </div>
						                                        <div class="card-block">
						                                            <div id="markers-map" class="set-map"></div>
						                                        </div>
						                                    </div>
                                    					<!-- Markers map end -->
                                                    	</div>
	                                              	</div> 
	                                            </div>
	                                        </div>
	                                        </c:if>
                                    	</div>
                                    <!-- Page-body end -->
                                </div>
                                <div id="styleSelector"> </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
	</section>
	<!-- End Service -->

	<%@include file="include/footer.jsp" %>
	<%@include file="include/footer_script.jsp" %>
<script type="text/javascript">
	currentSlide(1);
	
</script>
</body>
</html>